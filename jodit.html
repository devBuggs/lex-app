<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jodit Custom Font Size</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jodit@3.6.1/build/jodit.min.css">
</head>

<body>
    <textarea id="editor"></textarea>

    <script src="https://cdn.jsdelivr.net/npm/jodit@3.6.1/build/jodit.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fontFamilies = {
                'Geneva': 'Geneva',
                'Helvetica,sans-serif': 'Helvetica',
                'Arial,Helvetica,sans-serif': 'Arial',
                'Georgia,serif': 'Georgia',
                'Impact,Charcoal,sans-serif': 'Impact',
                'Tahoma,Geneva,sans-serif': 'Tahoma',
                "'Times New Roman',Times,serif": 'Times New Roman',
                'Verdana,Geneva,sans-serif': 'Verdana',
                'Roboto Medium,Arial,sans-serif': 'Roboto'
            };

            const updateButtonLabel = (editor, fontFamily=null) => {
                let fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                // let fontSizeButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                console.log("-- fontFamilyButton.innerHTML :: ", fontFamilyButton.innerHTML);
                // console.log("-- fontSizeButton.innerHTML :: ", fontSizeButton.innerHTML);

                if (typeof editor === "string") {
                    let domString = editor;
                    const regex = /font-family:\s*([^;]+);/;
                    const match = domString.match(regex);
                    // console.log("regex match == ", match)
                    if (match) {
                        console.log("Extracted Font Family :::", match[1]);
                        fontFamilyButton.innerHTML = match[1]
                    } else {
                        console.log("Font Family not found");
                        fontFamilyButton.innerHTML = 'Default'
                    }
                } else {
                    const currentStyle = editor.s.current();
                    let irmsBtn = editor.currentPlace.options.buttons.filter(item => item?.name === "irmsFontFamily")
                    console.log("=== currentStyle : ", currentStyle)
                    const currentFontFamily = currentStyle ? fontFamily : 'Default';
                    console.log("=== currentFontFamily : ", currentStyle)
                    const buttonText = fontFamilies[currentFontFamily] || 'failed';
                    if (fontFamilyButton) {
                        if (fontFamilyButton.innerHTML) {
                            fontFamilyButton.textContent = `${buttonText}`;
                        }
                    }
                }
            };

            const editor = new Jodit('#editor', {
                toolbarButtonSize: 'middle',
                buttons: ['bold', 'italic', 'underline', '|',
                    {
                        name: 'irmsFontFamily',
                        tooltip: 'Select Font Family',
                        text: 'Default',
                        popup: (editor, current, self, close) => {
                            const form = editor.create.fromHTML(
                                `<ul style="list-style-type: none; padding-inline-start: 0px;">
                                    ${Object.entries(fontFamilies).map(([value, label]) => `<li style="width:100%; margin: 10px 15px;">
                                        <a 
                                            href="#" 
                                            data-value="${value}" 
                                            style="font-family:${value}"
                                            onMouseOver="this.style.color='red'"
                                            onMouseOut="this.style.color='blue'" 
                                            >
                                            ${label}
                                        </a>
                                    </li>`).join('')}
                                </ul>`
                            );
                            form.querySelectorAll('a').forEach(a => {
                                a.addEventListener('click', (e) => {
                                    e.preventDefault();
                                    const fontFamily = e.target.getAttribute('data-value');
                                    editor.s.applyStyle({ fontFamily: fontFamily });
                                    updateButtonLabel(editor, fontFamily);
                                    close();
                                });
                            });
                            return form;
                        },
                        exec: (editor, current, self) => {
                            updateButtonLabel(editor);
                        }
                    },
                    {
                        name: 'irmsFontSize',
                        tooltip: 'Select Font Size',
                        popup: (editor, current, self, close) => {
                            const fontSizes = ['24px', '28px', '32px', '48px', '64px', '72px', '96px'];

                            const form = editor.create.fromHTML(
                                `<ul style="list-style-type: none; padding-inline-start: 0px;">
                                    ${Object.entries(fontSizes).map(([index, label]) => `<li style="width:100%; margin: 10px 15px;">
                                        <a 
                                            href="#" 
                                            data-value="${label}" 
                                            onMouseOver="this.style.color='red'"
                                            onMouseOut="this.style.color='blue'" 
                                            >
                                            ${label}
                                        </a>
                                    </li>`).join('')}
                                </ul>`
                            );

                            form.querySelectorAll('a').forEach(a => {
                                a.addEventListener('click', (e) => {
                                    e.preventDefault();
                                    const fontSize = e.target.getAttribute('data-value');
                                    editor.s.applyStyle({ fontSize: fontSize });
                                    close();
                                });
                            });

                            return form;
                        },
                        exec: (editor) => {
                            console.log("====== irmsFontSize btn clicked :: ")
                        }
                    }
                ],
                events: {
                    change: (editor) => {
                        console.log("editor.container - onchange:: ", JSON.stringify(editor));
                        const fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                        if (fontFamilyButton) {
                            updateButtonLabel(JSON.stringify(editor));
                        }
                    },
                    afterInit: (editor) => {
                        console.log("editor.container - afterInit:: ", JSON.stringify(editor));
                        const fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                        if (fontFamilyButton) {
                            updateButtonLabel(JSON.stringify(editor));
                        }
                    }
                }
            });
        });
    </script>
</body>

</html>