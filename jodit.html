<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jodit Custom Font Size</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jodit@3.6.1/build/jodit.min.css">
</head>

<body>
    <textarea id="editor"></textarea>

    <script src="https://cdn.jsdelivr.net/npm/jodit@3.6.1/build/jodit.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const fontFamilies = {
                '' : "Default",
                'Geneva': 'Geneva',
                'Helvetica,sans-serif': 'Helvetica',
                'Arial,Helvetica,sans-serif': 'Arial',
                'Georgia,serif': 'Georgia',
                'Impact,Charcoal,sans-serif': 'Impact',
                'Tahoma,Geneva,sans-serif': 'Tahoma',
                "'Times New Roman',Times,serif": 'Times New Roman',
                'Verdana,Geneva,sans-serif': 'Verdana',
                'Roboto Medium,Arial,sans-serif': 'Roboto'
            };

            const updateButtonLabel = (editor, value=null, type=null) => {
                let fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                let fontSizeButton = document.querySelector('span.jodit-toolbar-button.jodit-toolbar-button_size_middle.jodit-toolbar-button_irmsFontSize.jodit-toolbar-button_text-icons_true.jodit-toolbar-button_with-trigger_true.jodit-ui-group__irmsFontSize > button > span.jodit-toolbar-button__text');
                if (value !== null && type !== null) {
                    if (type === 'fontFamily') {
                        console.log("font-family provided - ", value)
                        fontFamilyButton.innerHTML = value;
                        return
                    } else if (type === 'fontSize') {
                        console.log("font-size provided - ", value)
                        fontSizeButton.innerHTML = value;
                        return
                    }
                }
                if (typeof editor === "string" && value === null && type === null) {
                    let domString = editor;
                    const regex = /font-family:\s*([^;]+);/;
                    const match = domString.match(regex);
                    if (match) {
                        console.log("Extracted Font Family :::", match[1]);
                        fontFamilyButton.innerHTML = match[1]
                    }
                } 
                if (typeof editor === 'object' && value === null) {
                    if (editor.selection != null) {
                        console.log("=== selectionApi Event : ", editor.selection.current())
                    }

                    if (editor?.s) {
                        //textApply a style to selected text
                        const currentStyle = editor.s.current();
                        console.log("=== selected text - currentStyle : ", currentStyle)
                        const currentFontFamily = currentStyle ? value : 'Default';
                        console.log("=== currentFontFamily : ", currentStyle);

                        const buttonText = fontFamilies[currentFontFamily] || fontFamily || 'Default';
                        if (fontFamilyButton) {
                            if (fontFamilyButton.innerHTML) {
                                fontFamilyButton.textContent = `${buttonText}`;
                            }
                        }
                    }
                }
            };

            const editor = new Jodit('#editor', {
                toolbarButtonSize: 'middle',
                buttons: ['bold', 'italic', 'underline', '|',
                    {
                        name: 'irmsFontFamily',
                        tooltip: 'Select Font Family',
                        text: 'Default',
                        popup: (editor, current, self, close) => {
                            const form = editor.create.fromHTML(
                                `<ul style="list-style-type: none; padding-inline-start: 0px;">
                                    ${Object.entries(fontFamilies).map(([value, label]) => `<li style="width:100%; margin: 10px 15px;">
                                        <a 
                                            href="#" 
                                            data-value="${value}" 
                                            style="font-family:${value}"
                                            onMouseOver="this.style.color='red'"
                                            onMouseOut="this.style.color='blue'" 
                                            >
                                            ${label}
                                        </a>
                                    </li>`).join('')}
                                </ul>`
                            );
                            form.querySelectorAll('a').forEach(a => {
                                a.addEventListener('click', (e) => {
                                    e.preventDefault();
                                    const fontFamily = e.target.getAttribute('data-value');
                                    updateButtonLabel(editor, fontFamily, 'fontFamily');
                                    editor.s.applyStyle({ fontFamily: fontFamily });
                                    close();
                                });
                            });
                            return form;
                        },
                        exec: (editor, current, self) => {
                            console.log("====== irmsfontFamily btn clicked :: ")
                        }
                    },
                    {
                        name: 'irmsFontSize',
                        tooltip: 'Select Font Size',
                        popup: (editor, current, self, close) => {
                            const fontSizes = ['24px', '28px', '32px', '48px', '64px', '72px', '96px'];
                            const form = editor.create.fromHTML(
                                `<ul style="list-style-type: none; padding-inline-start: 0px;">
                                    ${Object.entries(fontSizes).map(([index, label]) => `<li style="width:100%; margin: 10px 15px;">
                                        <a 
                                            href="#" 
                                            data-value="${label}" 
                                            onMouseOver="this.style.color='red'"
                                            onMouseOut="this.style.color='blue'" 
                                            >
                                            ${label}
                                        </a>
                                    </li>`).join('')}
                                </ul>`
                            );

                            form.querySelectorAll('a').forEach(a => {
                                a.addEventListener('click', (e) => {
                                    e.preventDefault();
                                    const fontSize = e.target.getAttribute('data-value');
                                    editor.s.applyStyle({ fontSize: fontSize });
                                    updateButtonLabel(editor, fontSize, 'fontSize');
                                    close();
                                });
                            });

                            return form;
                        },
                        exec: (editor) => {
                            console.log("====== irmsFontSize btn clicked :: ")
                        }
                    }
                ],
                events: {
                    change: (editor) => {
                        console.log("editor.container - onchange:: ",typeof editor);
                        const fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                        if (fontFamilyButton) {
                            updateButtonLabel(editor);
                        }
                    },
                    afterInit: (editor) => {
                        console.log("editor.container - afterInit:: ",typeof editor);
                        const fontFamilyButton = document.querySelector('.jodit-toolbar-button__icon:empty+.jodit-toolbar-button__text:not(:empty)');
                        if (fontFamilyButton) {
                            updateButtonLabel(editor);
                        }
                    }
                }
            });
        });
    </script>
</body>

</html>